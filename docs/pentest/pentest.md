# Penetration Testing Documentation Report

## 1. Executive Summary
During this penetration test I have tested the connections between 2 key components of the network by scanning their properties and what kind of vulnerabilities they might be weak against. I have found a critical vulnerability which might cause the website to malfunction the moment it is under attack, therefore i recommend to have a specialist set a limit on the connection to make sure this will not be happening.

## 2. Introduction
In this penetration test i will be trying to find and exploit a vulnerability in the connection between the reverse proxy and the webserver, we have 2 webservers but because their configuration is exactly the same, i will only be attacking a single one. I will first try to scan the network searching for vulnerabilities with Nmap and then proceed to exploit that vulnerability when i find it.

## 3. Scope
During this pentest we will be testing the entire network, this will happen from 14:00 until 16:30. The target of the pentest is the connection between 192.168.1.10 and 10.0.1.2. 192.168.1.10 falls under the localhost domain. 3rd parties don't have to be tested.

### 3.1 Goals
- Finding security flaws in the connection between 172.16.3.2 and 10.0.1.2

### 3.2 Box
As i have complete access to all the code and configuration, this will be a white box approach.

## 4. Methodology
To test what the reverse proxy can receive, we scan the ports using Nmap
```
root@router:/opt/init# nmap -sT 10.0.1.2
Starting Nmap 7.80 ( https://nmap.org ) at 2024-04-02 11:20 UTC
Nmap scan report for 10.0.1.2
Host is up (0.028s latency).
Not shown: 998 closed ports
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  https
```


This shows that only port 80 and port 443 are open which is exactly how it should be.

## 5. Findings
### 5.1 Vulnerabilities

#### Slowloris (Impact: Critical)
Using `nmap -sV --script vuln 192.168.1.10` to run a scan for vulnerabilities reveals that there is 1 vulnerability to be aware of
```
root@nginx:/opt/init# nmap --script http-slowloris-check 192.168.1.10
Starting Nmap 7.80 ( https://nmap.org ) at 2024-04-02 13:06 UTC
Nmap scan report for 192.168.1.10
Host is up (0.0098s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
80/tcp open  http
| http-slowloris-check:
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server's resources causing Denial Of Service.
|
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
```
This vulnerability reveals a Slowloris vulnerability, slowloris is a type of attack that opens connections on a server but doesn't send actual requests. This way the http server reserves resources for receiving the request but that request never arrives, this is a Denial of Service attack that can run without needing too much resources. This makes it accessible for many to use. Using this exploit on the server might cause a Denial of Service which makes people unable to make use of the website, therefore this is a critical issue.

### 5.2 Exploitation Results
While running a slowloris attack on the webserver, i noticed that i wasn't able to take down the server or make it inaccessible. But, the web-server reached CPU percentages over 100% which indicates that if i was executing this attack on a larger scale this will be effective, but right now i was only running it from a single interface, the reverse proxy. The reason the web server didn't crash is because docker has 10 cores allocated from my machine so it has a total of 1000% CPU capacity.

### 5.3 Observations
slowloris seemed to have a cap of around 1100 sockets. 

## 6. Recommendations
I would recommend adding a limitation to connections coming from certain ip-adresses, while this attack can be done on a large scale, the fact that you can open hundreds of sockets from every single interface is the greatest risk.

## 7. Conclusion
Overall, the connection is secure but it can get overloaded if you do it correctly, correcting this is a high priority and i recommend you fix it as soon as possible. Otherwise the webserver is vulnerable to being brought down at any time.

